---
title: "Mini-Project 2"
author: "Your Name Here"
date: "October 31, 2017"
output: html_document
---


## Loading the data

This project is so interesting and relevant to my life!

```{r,message=FALSE}
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")


library(tidyverse)
library(dplyr)

contributions <- contributions %>%
  full_join(candidates,by = "cand_id")

contributions1<-contributions %>% 
  select(cand_id,cand_ici, entity_type, transaction_amt, transaction_dt, transaction_type)

require(lubridate)
contributions2 <- contributions1 %>%
  mutate(transaction_date= mdy(`transaction_dt`)) %>%
  filter(transaction_date> "2012-01-01" & transaction_date <"2012-12-31")

contributions2$entity_type[contributions2$entity_type==""] <-NA

glimpse(contributions2)
```
install.packages("plotly")
require(plotly)
require(scales)
```

```{r,message=FALSE}
m <-ggplot(data = contributions2, aes(x =transaction_date, y = transaction_amt/1000000, color = entity_type, shape = entity_type)) +  
  scale_shape_manual(values=10:nlevels(contributions2$entity_type)) + 
  labs(title = "change of transaction amount among between 2010 and 2012 on different entity type")+
  guides(color = guide_legend("entity type")) +
  geom_smooth() +
  facet_wrap(~entity_type)+
  scale_y_continuous("Transaction Amount/million", labels = scales::dollar) +
  scale_x_date(date_breaks = "3 months") + 
  theme(axis.text.x = element_text(angle = 60, hjust = 1))
  m
```
ggplotly(p = m)


```{r,message=FALSE}

ggplot(data = contributions2, aes(x = entity_type, y =transaction_amt/1000000))+
  labs(x = "Transaction Type", y="Transaction Amount/million", title = "Transaction Amount in 2012 for Different Entity Type") +
  scale_y_continuous(labels = scales::dollar) +
  geom_bar(stat="identity")
  
  
```

```{r,message=FALSE}
contribution3<- contributions2 %>%
  filter(transaction_type== c("24E","24A"))

ggplot(data = contribution3,aes(x = transaction_type, y = transaction_amt/1000000, fill = entity_type))+
  labs( x = "Entity Type", y="Transaction Amount/million", title = "Transaction Amount in 2012 for Different Entity Type", fill="Transaction Type")+
  scale_y_continuous(labels = scales::dollar) +
  geom_bar(stat = "identity")
```

join candidates with contributions by cand_id
compare cand_ici with entity_type
we want to see where the money is coming from for challengers vs incumbents vs open seats CAN = Candidate
CCM = Candidate Committee
COM = Committee
IND = Individual (a person)
ORG = Organization (not a committee and not a person)
PAC = Political Action Committee
PTY = Party Organization


